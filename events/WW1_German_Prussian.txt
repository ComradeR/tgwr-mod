add_namespace = prussian

# Russian Empire is victorious over Germany before Soviet revolution fired
# The Occupation of Memel
country_event = {
	id = prussian.1
	title = prussian.1.t
	desc = prussian.1.d
	fire_only_once = yes
	trigger = {
		tag = RUS
		GER = {
			has_country_flag = great_war_loser
			owns_state = 188
		}
		RUS = {
			has_country_flag = great_war_winner
		}
		NOT = { has_global_flag = russian_revolution }
	}
	mean_time_to_happen = { days = 50 }
	option = {
		name = prussian.1.a
		ai_chance = { factor = 100 }

		if = {
			limit = {
				LIT = { exists = no }
			}
			RUS = { transfer_state = 188 }
		}

		if = {
			limit = {
				LIT = { exists = yes is_subject_of = RUS }
			}
			LIT = { transfer_state = 188 add_state_core = 188 }
		}

		hidden_effect = {
			set_global_flag = prussian_blue
		}
	}
}
# Proposal of Treaty of Brussels
country_event = {
	id = prussian.2
	title = prussian.2.t
	desc = prussian.2.d
	fire_only_once = yes
	trigger = {
		tag = RUS
		has_global_flag = prussian_blue

		RUS = {
			has_war = no
			has_country_flag = great_war_winner
		}
		FRA = {
			has_war = no
			has_country_flag = great_war_winner
		}
		USA = {
			NOT = { has_country_flag = great_war_winner }
		}
	}
	mean_time_to_happen = { days = 7 }
	option = {
		name = prussian.2.a
		ai_chance = { factor = 100 }

		FRA = { country_event = { id = prussian.3 days = 1 } }

		if = {
			limit = {
				ENG = { has_country_flag = great_war_winner }
			}
			ENG = { country_event = { id = prussian.3 days = 1 } }
		}
	}
}
# Response on Proposal of Treaty of Brussels
country_event = {
	id = prussian.3
	title = prussian.3.t
	desc = prussian.3.d
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = prussian.3.a
		ai_chance = { factor = 80 }
		set_country_flag = agreed_on_treaty_of_berlin
	}
	option = {
		name = prussian.3.b
		ai_chance = { factor = 20 }
	}
}
# Treaty of Brussels
news_event = {
	id = prussian.4
	title = prussian.4.t
	picture = EVENT_hoi4tgw_treaty_of_versailles
	desc = {
		text = prussian.4.desc
		trigger = {
			ENG = { has_country_flag = agreed_on_treaty_of_berlin }
			FRA = { has_country_flag = agreed_on_treaty_of_berlin }
		}
	}
	desc = {
		text = prussian.4.desc_britain
		trigger = {
			ENG = { has_country_flag = agreed_on_treaty_of_berlin }
			FRA = { NOT = { has_country_flag = agreed_on_treaty_of_berlin } }
		}
	}
	desc = {
		text = prussian.4.desc_france
		trigger = {
			FRA = { has_country_flag = agreed_on_treaty_of_berlin }
			ENG = { NOT = { has_country_flag = agreed_on_treaty_of_berlin } }
		}
	}
	fire_only_once = yes
	major = yes
	trigger = {
		has_global_flag = prussian_blue
		OR = {
			ENG = { has_country_flag = agreed_on_treaty_of_berlin }
			FRA = { has_country_flag = agreed_on_treaty_of_berlin }
		}
	}
	mean_time_to_happen = { days = 14 }
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					FRA = { has_country_flag = agreed_on_treaty_of_berlin }
				}
				create_dynamic_country = {
					original_tag = GER
					set_capital = 55
					set_politics = {
						ruling_party = democratic
						elections_allowed = yes
					}
					set_popularities = {
						democratic = 64
						neutrality = 15
						fascism = 6
						communism = 15
					}
					set_country_flag = great_war_loser
					set_country_flag = GER_rhine_federation_flag
					set_cosmetic_tag = RHN
					28 = { remove_core_of = GER }
					every_state = {
						limit = {
							is_core_of = GER
						}
						remove_core_of = PREV
					}
					every_state = {
						limit = {
							is_core_of = GER
							is_owned_by = FRA
							NOT = { state = 28 }
						}
						add_core_of = PREV
					}
					add_state_core = 55
					add_state_core = 343
					transfer_state = 55
					transfer_state = 343
					reserve_dynamic_country = yes
				}
				every_state = {
					limit = {
						is_core_of = RHN
					}
					RHN = {
						transfer_state = PREV
					}
					GER = {
						remove_state_core = PREV
					}
				}
				FRA = {
					puppet = RHN

					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = RHN
							autonomous_state = autonomy_tgwr_protectorate
							freedom_level = 0.5
						}
						RHN = { set_country_flag = protectorate }
					}
				}
				RHN = {
					set_politics = {
						ruling_party = fascism
						elections_allowed = yes
					}
					set_popularities = {
						democratic = 34
						neutrality = 15
						fascism = 36
						communism = 15
					}
					set_party_name = { 
						ideology = fascism
						long_name = RHN_french_military_long
						name = RHN_french_military
					}
					set_party_name = { 
						ideology = democratic
						long_name = GER_democratic_party_zentrum_long
						name = GER_democratic_party_zentrum
					}
					create_country_leader = {
						name = "French Military Government"
						picture = "gfx/leaders/FRA/FRA_provisional_government.dds" 
						expire = "1935.1.1"
						ideology = military_dictatorship
						traits = {}
					}
					create_country_leader = {
						name = "Konrad Adenauer"
						picture = "gfx/leaders/GER/GER_Konrad_Adenauer.dds"
						expire = "1935.1.1"
						ideology = conservatism
						traits = {}
					}
					add_ideas = democratic_influence
				}
			}
			GER = {
				release = HAN
				release = SHL
			}
			HAN = {
				annex_country = {
					target = SHL
				}
				every_state = {
					limit = {
						is_owned_by = HAN
						NOT = { is_core_of = HAN }
					}
					add_core_of = HAN
				}
				set_politics = {
					ruling_party = democratic
					elections_allowed = yes
				}
				set_popularities = {
					democratic = 54
					neutrality = 35
					fascism = 6
					communism = 5
				}
				set_party_name = { 
					ideology = democratic
					long_name = GER_democratic_party_long
					name = GER_democratic_party
				}
				set_party_name = { 
					ideology = neutrality
					long_name = GER_neutrality_party
					name = GER_neutrality_party
				}
				set_party_name = { 
					ideology = communism
					long_name = GER_communism_party
					name = GER_communism_party
				}
				create_country_leader = { 
					name = "Friedrich Ebert"
					picture = "gfx/leaders/GER/GER_friedrich_ebert.dds" 
					expire = "1935.1.1" 
					ideology = socialism
					traits = {} 
				}
				set_cosmetic_tag = HAN_niederdeutschland
			}
			if = {
				limit = {
					ENG = { has_country_flag = agreed_on_treaty_of_berlin }
				}
				ENG = {
					puppet = HAN

					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = HAN
							autonomous_state = autonomy_tgwr_informal_protectorate
							freedom_level = 0.5
						}
						HAN = { set_country_flag = protectorate }
					}
				}
			}
			GER = {
				release = BAV
				release = SAX
				release = WUR
				set_cosmetic_tag = PRE
				load_focus_tree = {
					tree = generic_focus
					keep_completed = no
				}
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				set_popularities = {
					democratic = 27
					neutrality = 53
					fascism = 12
					communism = 8
				}
			}
			BAV = {
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				set_popularities = {
					democratic = 32
					neutrality = 21
					fascism = 0
					communism = 47
				}
				set_party_name = { 
					ideology = communism
					long_name = GER_communism_party
					name = GER_communism_party
				}
				add_ideas = communist_influence
			}
			WUR = {
				set_politics = {
					ruling_party = democratic
					elections_allowed = yes
				}
				set_popularities = {
					democratic = 54
					neutrality = 13
					fascism = 1
					communism = 32
				}
				set_cosmetic_tag = BADWUR
			}
			if = {
				limit = {
					FRA = { has_country_flag = agreed_on_treaty_of_berlin }
				}

				FRA = {
					puppet = WUR

					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = WUR
							autonomous_state = autonomy_tgwr_protectorate
							freedom_level = 0.5
						}
						WUR = { set_country_flag = protectorate }
					}
				}
			}
			if = {
				limit = {
					FRA = { has_country_flag = agreed_on_treaty_of_berlin }
					ENG = { has_country_flag = agreed_on_treaty_of_berlin }
				}

				RUS = {
					puppet = GER

					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = GER
							autonomous_state = autonomy_dominion
							freedom_level = 0.5
						}
					}

					if = {
						limit = {
							POL = {
								exists = yes
								is_subject_of = RUS
							}
						}
						POL = {
							add_state_core = 762
							transfer_state = 762
						}
					}

					if = {
						limit = {
							POL = {
								exists = no
							}
						}
						RUS = {
							transfer_state = 762
						}
					}
				}
			}
			if = {
				limit = {
					OR = {
						NOT = { FRA = { has_country_flag = agreed_on_treaty_of_berlin } }
						NOT = { ENG = { has_country_flag = agreed_on_treaty_of_berlin } }
					}
				}

				if = {
					limit = {
						POL = { exists = yes is_subject_of = RUS }
					}
					POL = {
						add_state_core = 85
						add_state_core = 86
						add_state_core = 762
						transfer_state = 85
						transfer_state = 86
						transfer_state = 762
					}
				}
				if = {
					limit = {
						POL = { exists = no }
					}

					RUS = {
						transfer_state = 85
						transfer_state = 86
						transfer_state = 762
					}
				}
			}
			if = {
				limit = {
					GER = {
						owns_state = 55
						owns_state = 343
					}
					FRA = {
						NOT = { has_country_flag = agreed_on_treaty_of_berlin }
					}
				}

				GER = {
					remove_state_core = 55
					remove_state_core = 343
				}

				HAN = {
					add_state_core = 55
					add_state_core = 343
					transfer_state = 55
					transfer_state = 343
				}
			}
			if = {
				limit = {
					HAN = {
						owns_state = 60
					}
				}
				HAN = {
					remove_state_core = 60
				}
				GER = {
					add_state_core = 60
					transfer_state = 60
				}
			}
			GER = {
				puppet = SAX

				if = {
					limit = {
						has_dlc = "Together for Victory"
					}
					set_autonomy = {
						target = SAX
						autonomous_state = autonomy_dominion
						freedom_level = 0.5
					}
				}
			}
			if = {
				limit = {
					AUS = {
						exists = yes
						NOT = { owns_state = 102 }
					}
				}

				AUS = {
					transfer_state = 102
				}
			}
			GER = {
				transfer_units_fraction= {
					target = BAV
					size = 0.3
					stockpile_ratio = 0.4
					army_ratio = 0.3
					navy_ratio = 0.0
					air_ratio = 0.1
				}
				transfer_units_fraction= {
					target = WUR
					size = 0.1
					stockpile_ratio = 0.1
					army_ratio = 0.1
					navy_ratio = 0.0
					air_ratio = 0.1
				}
				transfer_units_fraction= {
					target = WUR
					size = 0.1
					stockpile_ratio = 0.1
					army_ratio = 0.1
					navy_ratio = 0.0
					air_ratio = 0.0
				}
				transfer_units_fraction= {
					target = HAN
					size = 0.2
					stockpile_ratio = 0.5
					army_ratio = 0.4
					navy_ratio = 0.4
					air_ratio = 0.3
				}
				if = {
					limit = {
						FRA = { has_country_flag = agreed_on_treaty_of_berlin }
					}
					transfer_units_fraction= {
						target = RHN
						size = 0.1
						stockpile_ratio = 0.1
						army_ratio = 0.1
						navy_ratio = 0.0
						air_ratio = 0.1
					}
				}
			}
		}
	}
	option = {
		name = prussian.4.a
		trigger = {
			OR = {
				original_tag = GER
				has_country_flag = great_war_loser
				tag = BAV
				tag = SAX
				tag = WUR
				tag = HAN
			}
		}
	}
	option = {
		name = prussian.4.b
		trigger = {
			has_country_flag = agreed_on_treaty_of_berlin
		}
	}
	option = {
		name = prussian.4.c
		trigger = {
			NOT = {
				OR = {
					original_tag = GER
					has_country_flag = great_war_loser
					has_country_flag = agreed_on_treaty_of_berlin
					tag = BAV
					tag = SAX
					tag = WUR
					tag = HAN
					tag = ROM
					tag = CZE
					tag = SER
				}
			}
		}
	}
	option = {
		name = prussian.4.d
		trigger = {
			OR = {
				tag = ROM
				tag = CZE
				tag = SER
			}
		}
	}
}
# Bavarian Soviet Republic
news_event = {
	id = prussian.5
	title = prussian.5.t
	desc = prussian.5.d
	picture = GFX_news_event_ger_civil_war
	fire_only_once = yes
	trigger = {
		has_global_flag = prussian_blue

		BAV = {
			exists = yes
			is_subject = no
			communism > 0.5
		}
	}
	major = yes
	immediate = {
		hidden_effect = {
			BAV = {
				set_politics = {
					ruling_party = communism
				}

				set_cosmetic_tag = BAV_communism
			}
		}
	}
	option = {
		name = prussian.5.a
		ai_chance = { factor = 100 }
		trigger = {
			OR = {
				tag = BAV
				has_government = communism
			}
		}
	}
	option = {
		name = prussian.5.b
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				OR = {
					tag = BAV
					has_government = communism
				}
			}
		}
	}
}